# Atlas construction

## Generating training data for MIDAS

```bash
Rscript preprocess/combine_subsets.R --task atlas && py preprocess/split_mat.py --task atlas &
```

## Training MIDAS

```bash
CUDA_VISIBLE_DEVICES=0 py run.py --exp e0 --task atlas
```

## Inferring latent variables, and generating imputed and batch corrected counts

```bash
CUDA_VISIBLE_DEVICES=0 py run.py --task atlas --act predict_all_latent_bc --init_model sp_latest &
```

## Evaluation

UMAP visualization of the joint embeddings generated by MIDAS in atlas construction:

```bash
Rscript comparison/vis_z_atlas.r --init_model sp_latest --task atlas 
```
